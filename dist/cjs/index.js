(()=>{"use strict";var e={n:t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};e.d(t,{default:()=>c});const r=require("webtorrent-hybrid");var n=e.n(r);const o=["wss://tracker.eueno.io","https://tracker.eueno.io/announce"],a=require("axios");var i=e.n(a);const d=async(e,t,r)=>{try{return(await i()({method:"put",url:t.urlUploadFile,headers:{"Content-Type":`${r.contentType}`},data:e})).status}catch(e){return`error upload file to eueno ${e}`}},l=async(e,t)=>{try{return(await i()({method:"put",url:t.urlUploadTorrent,headers:{"Content-Type":"application/x-bittorrent"},data:e})).status}catch(e){return`error upload file to eueno ${e}`}},u=new(n())({dht:!1}),c=class{constructor(e={}){if(void 0===e.endpoint)throw new Error("end point invalid");this.endpoint=e.endpoint,this.nodeId=u.nodeId,this.peerId=u.peerId}async upload(e,t,r){if(void 0===r.contentLength)throw new Error("contentLength invalid");if(void 0===r.contentType)throw new Error("contentType invalid");if(void 0===r.filename)throw new Error("filename invalid");if(void 0===r.action)throw new Error("action invalid");if(void 0===r.encryption)throw new Error("encryption invalid");if(void 0===t.bucketKey)throw new Error("bucketKey invalid");return t.endpoint=this.endpoint,(async(e,t,r)=>{let n=e;if("string"==typeof e)throw new Error("Only buffer file");let a=await(async(e,t)=>{try{return(await i()({method:"post",url:`${e.endpoint}/api/v2/api/project-file/auth-upload`,headers:{"x-api-project-key":e.bucketKey,"Content-Type":"application/json"},data:JSON.stringify({metadata:{content_length:t.contentLength,content_type:t.contentType,filename:t.filename,action:t.action,encryption:t.encryption}})})).data}catch(e){return`error request sign url ${e}`}})(t,r);if(200!==a.status)throw new Error(`error request sign ${JSON.stringify(a)}`);t.urlList=a.data.webseed,t.urlUploadFile=a.data.url_upload_file,t.urlUploadTorrent=a.data.url_upload_torrent,t=await async function(e){return void 0!==e.announce?e.announce=e.announce.cancat(o):e.announce=o,e.private=!0,e}(t);let c=await((e,t,r)=>new Promise((n=>{e.seed(t,r,(e=>{n(e.torrentFile)}))})))(u,e,t);const[p,s]=await Promise.all([d(n,t,r),l(c,t)]);if(200!==p)throw new Error(p);if(200!==s)throw new Error(s);return{torrent:a.data.torrent_url,filename:a.data.filename}})(e,t,r)}};var p=exports,s=t.default;for(var f in s)p[f]=s[f];s.__esModule&&Object.defineProperty(p,"__esModule",{value:!0})})();